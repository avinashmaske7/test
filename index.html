<form id="test-form">
  <input name="name" placeholder="Name" required>
  <input name="email" type="email" placeholder="Email" required>
  <input name="subject" placeholder="Subject" required>
  <textarea name="message" placeholder="Message" required></textarea>
  <button type="submit">Send</button>
</form>

<p id="status"></p>

<script>
document.getElementById("test-form")
  .addEventListener("submit", function (e) {
    e.preventDefault();
    document.getElementById("status").textContent = "Sending…";

    const data = {
      name: this.name.value,
      email: this.email.value,
      subject: this.subject.value,
      message: this.message.value
    };

    fetch("https://script.google.com/macros/s/AKfycbwXDeLPOwnCRB89uF2qwziJH_gZNaEL3YNR-PINJcIoLV43USPqu6EC2YaxDkd09f1Y0w/exec", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    })
    .then(res => {
      if (!res.ok) throw new Error("HTTP " + res.status);
      return res.json();
    })
    .then(resData => {
      document.getElementById("status").textContent = "✅ Success!";
    })
    .catch(err => {
      console.error("Error:", err);
      document.getElementById("status").textContent = "❌ Failed to send. See console.";
    });
});
</script>
